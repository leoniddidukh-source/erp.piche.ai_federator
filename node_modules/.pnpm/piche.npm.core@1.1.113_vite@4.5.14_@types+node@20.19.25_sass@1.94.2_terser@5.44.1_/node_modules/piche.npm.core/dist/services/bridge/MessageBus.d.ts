import type { BridgeEvents, BridgeMessage, BridgeRequests, MessageHandler, RequestHandler } from '../../types/bridge';
type EventKey = keyof BridgeEvents;
type RequestKey = keyof BridgeRequests;
export declare class MessageBus {
    private static instance;
    private eventListeners;
    private requestHandlers;
    private pendingRequests;
    private errorListeners;
    static getInstance(): MessageBus;
    onError(handler: (error: Error, context?: {
        message?: BridgeMessage;
    }) => void): () => void;
    onEvent<K extends EventKey>(event: K, handler: MessageHandler<BridgeEvents[K]>, onError?: (err: Error, msg?: BridgeMessage) => void): () => void;
    emit<K extends EventKey>(event: K, payload: BridgeEvents[K], source: string, target?: string): void;
    onRequest<K extends RequestKey>(type: K, handler: RequestHandler<BridgeRequests[K]['request'], BridgeRequests[K]['response']>): () => void;
    request<K extends RequestKey>(type: K, payload: BridgeRequests[K]['request'], source: string, target?: string): Promise<BridgeRequests[K]['response']>;
    private respond;
    private deliverMessage;
    private handleEvent;
    private handleRequest;
    private handleResponse;
    private respondError;
    private emitError;
}
export declare const messageBus: MessageBus;
export {};
